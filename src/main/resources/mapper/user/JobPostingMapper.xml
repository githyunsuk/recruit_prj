<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.sist.user.mapper.JobPostingMapper">

  <resultMap id="jobPostResultMap" type="kr.co.sist.user.dto.JobPostDTO">
    <result property="jobPostingSeq" column="jobPostingSeq"/>
    <result property="postingTitle" column="postingTitle"/>
    <result property="postingDetail" column="postingDetail"/>
    <result property="expLevel" column="expLevel"/>
    <result property="recruitCnt" column="recruitCnt"/>
    <result property="salary" column="salary"/>
    <result property="postingStartDt" column="postingStartDt"/>
    <result property="postingEndDt" column="postingEndDt"/>
    <result property="workday" column="workday"/>
    <result property="workStartTime" column="workStartTime"/>
    <result property="workEndTime" column="workEndTime"/>
    <result property="viewCnt" column="viewCnt"/>
    <result property="zipcode" column="zipcode"/>
    <result property="roadAddress" column="roadAddress"/>
    <result property="detailAddress" column="detailAddress"/>
    <result property="corpNm" column="corpNm"/>
    <result property="corpInfo" column="corpInfo"/>
    <result property="corpUrl" column="corpUrl"/>
    <result property="positionName" column="positionName"/> 
  </resultMap>

  <!-- 전체 공고 조회 -->
  <select id="selectAllJobPostings" resultMap="jobPostResultMap">
    SELECT 
      jp.job_posting_seq AS jobPostingSeq, 
      jp.posting_title AS postingTitle, 
      jp.posting_detail AS postingDetail,
      jp.exp_level AS expLevel, 
      jp.recruit_cnt AS recruitCnt, 
      jp.salary AS salary, 
      jp.posting_start_dt AS postingStartDt, 
      jp.posting_end_dt AS postingEndDt, 
      jp.workday AS workday, 
      jp.work_start_time AS workStartTime, 
      jp.work_end_time AS workEndTime, 
      jp.view_cnt AS viewCnt, 
      jp.zipcode AS zipcode, 
      jp.road_address AS roadAddress, 
      jp.detail_address AS detailAddress, 
      c.corp_nm AS corpNm, 
      c.corp_info AS corpInfo, 
      c.corp_url AS corpUrl,
      pc.position_name AS positionName
    FROM JOB_POSTING jp 
    JOIN COMPANY c ON jp.corp_no = c.corp_no
    JOIN POSITION_CODE pc ON jp.position_seq = pc.position_seq 
   
  </select>

  <!-- 특정 jobPostingSeq에 해당하는 공고 조회 -->
  <select id="selectJobPostingsBySeq" parameterType="Integer" resultMap="jobPostResultMap">
    SELECT 
      jp.job_posting_seq AS jobPostingSeq, 
      jp.posting_title AS postingTitle, 
      jp.posting_detail AS postingDetail,
      jp.exp_level AS expLevel, 
      jp.recruit_cnt AS recruitCnt, 
      jp.salary AS salary, 
      jp.posting_start_dt AS postingStartDt, 
      jp.posting_end_dt AS postingEndDt, 
      jp.workday AS workday, 
      jp.work_start_time AS workStartTime, 
      jp.work_end_time AS workEndTime, 
      jp.view_cnt AS viewCnt, 
      jp.zipcode AS zipcode, 
      jp.road_address AS roadAddress, 
      jp.detail_address AS detailAddress, 
      c.corp_nm AS corpNm, 
      c.corp_info AS corpInfo, 
      c.corp_url AS corpUrl
    FROM JOB_POSTING jp 
    JOIN COMPANY c ON jp.corp_no = c.corp_no
    WHERE jp.job_posting_seq = #{jobPostingSeq}
  </select>

</mapper>